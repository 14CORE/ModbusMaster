<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>ModbusMaster: ModbusMaster Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ModbusMaster
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('class_modbus_master.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a> &#124;
<a href="class_modbus_master-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">ModbusMaster Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Arduino class library for communicating with Modbus slaves over RS232/485 (via RTU protocol).  
 <a href="class_modbus_master.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_modbus_master_8h_source.html">ModbusMaster.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:gac33a5bbc8188eb4a3a9a6bf8494bdc27"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__setup.html#gac33a5bbc8188eb4a3a9a6bf8494bdc27">ModbusMaster</a> ()</td></tr>
<tr class="memdesc:gac33a5bbc8188eb4a3a9a6bf8494bdc27"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="group__setup.html#gac33a5bbc8188eb4a3a9a6bf8494bdc27"></a><br/></td></tr>
<tr class="separator:gac33a5bbc8188eb4a3a9a6bf8494bdc27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga79102d6dd559b647c8a5a385184b89cd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__setup.html#ga79102d6dd559b647c8a5a385184b89cd">ModbusMaster</a> (uint8_t)</td></tr>
<tr class="separator:ga79102d6dd559b647c8a5a385184b89cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga508ecee40cf75898f27f8404c1574164"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__setup.html#ga508ecee40cf75898f27f8404c1574164">ModbusMaster</a> (uint8_t, uint8_t)</td></tr>
<tr class="separator:ga508ecee40cf75898f27f8404c1574164"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0f393213ede2f78801fca5add4eab139"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__setup.html#ga0f393213ede2f78801fca5add4eab139">begin</a> ()</td></tr>
<tr class="memdesc:ga0f393213ede2f78801fca5add4eab139"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize class object.  <a href="group__setup.html#ga0f393213ede2f78801fca5add4eab139"></a><br/></td></tr>
<tr class="separator:ga0f393213ede2f78801fca5add4eab139"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabc1145dc790c2b8da2d5c20ff34b187e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__setup.html#gabc1145dc790c2b8da2d5c20ff34b187e">begin</a> (uint16_t)</td></tr>
<tr class="separator:gabc1145dc790c2b8da2d5c20ff34b187e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea6654dac81e6b692dd6a1b0be8a218e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_modbus_master.html#aea6654dac81e6b692dd6a1b0be8a218e">idle</a> (void(*)())</td></tr>
<tr class="memdesc:aea6654dac81e6b692dd6a1b0be8a218e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set idle time callback function (cooperative multitasking).  <a href="#aea6654dac81e6b692dd6a1b0be8a218e"></a><br/></td></tr>
<tr class="separator:aea6654dac81e6b692dd6a1b0be8a218e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5e932dcb444f23094d6bf74963c5dccc"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__buffer.html#ga5e932dcb444f23094d6bf74963c5dccc">getResponseBuffer</a> (uint8_t)</td></tr>
<tr class="memdesc:ga5e932dcb444f23094d6bf74963c5dccc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve data from response buffer.  <a href="group__buffer.html#ga5e932dcb444f23094d6bf74963c5dccc"></a><br/></td></tr>
<tr class="separator:ga5e932dcb444f23094d6bf74963c5dccc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga492bf8f5389f1fca62d3666028070edb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__buffer.html#ga492bf8f5389f1fca62d3666028070edb">clearResponseBuffer</a> ()</td></tr>
<tr class="memdesc:ga492bf8f5389f1fca62d3666028070edb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear Modbus response buffer.  <a href="group__buffer.html#ga492bf8f5389f1fca62d3666028070edb"></a><br/></td></tr>
<tr class="separator:ga492bf8f5389f1fca62d3666028070edb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaef93f45298dfab2a7816bd38dac34bc9"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__buffer.html#gaef93f45298dfab2a7816bd38dac34bc9">setTransmitBuffer</a> (uint8_t, uint16_t)</td></tr>
<tr class="memdesc:gaef93f45298dfab2a7816bd38dac34bc9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Place data in transmit buffer.  <a href="group__buffer.html#gaef93f45298dfab2a7816bd38dac34bc9"></a><br/></td></tr>
<tr class="separator:gaef93f45298dfab2a7816bd38dac34bc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6fa2ccf75a0377cd38f848af42595656"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__buffer.html#ga6fa2ccf75a0377cd38f848af42595656">clearTransmitBuffer</a> ()</td></tr>
<tr class="memdesc:ga6fa2ccf75a0377cd38f848af42595656"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear Modbus transmit buffer.  <a href="group__buffer.html#ga6fa2ccf75a0377cd38f848af42595656"></a><br/></td></tr>
<tr class="separator:ga6fa2ccf75a0377cd38f848af42595656"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa935379dce2bb6c9da095e4bff896e1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aaa935379dce2bb6c9da095e4bff896e1"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>beginTransmission</b> (uint16_t)</td></tr>
<tr class="separator:aaa935379dce2bb6c9da095e4bff896e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6778a8da4587d8758f0c7cfe893d4edf"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6778a8da4587d8758f0c7cfe893d4edf"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>requestFrom</b> (uint16_t, uint16_t)</td></tr>
<tr class="separator:a6778a8da4587d8758f0c7cfe893d4edf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5edca67c6f99e9714bd60f376ab7141e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5edca67c6f99e9714bd60f376ab7141e"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>sendBit</b> (bool)</td></tr>
<tr class="separator:a5edca67c6f99e9714bd60f376ab7141e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7d73359543607e7834e475139004e6a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad7d73359543607e7834e475139004e6a"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>send</b> (uint8_t)</td></tr>
<tr class="separator:ad7d73359543607e7834e475139004e6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7da1f366af28e30540450ad731a3879"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae7da1f366af28e30540450ad731a3879"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>send</b> (uint16_t)</td></tr>
<tr class="separator:ae7da1f366af28e30540450ad731a3879"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a852873e0a13c899358d37a13da8d9e0c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a852873e0a13c899358d37a13da8d9e0c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>send</b> (uint32_t)</td></tr>
<tr class="separator:a852873e0a13c899358d37a13da8d9e0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55ff79608f37f9d19e0a5741089a08e1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a55ff79608f37f9d19e0a5741089a08e1"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>available</b> (void)</td></tr>
<tr class="separator:a55ff79608f37f9d19e0a5741089a08e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a339bd39533db98ed0dc444a89ee8420b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a339bd39533db98ed0dc444a89ee8420b"></a>
uint16_t&#160;</td><td class="memItemRight" valign="bottom"><b>receive</b> (void)</td></tr>
<tr class="separator:a339bd39533db98ed0dc444a89ee8420b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga560b271d9e1ccd1294f64e1bd01aa5d1"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__discrete.html#ga560b271d9e1ccd1294f64e1bd01aa5d1">readCoils</a> (uint16_t, uint16_t)</td></tr>
<tr class="memdesc:ga560b271d9e1ccd1294f64e1bd01aa5d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modbus function 0x01 Read Coils.  <a href="group__discrete.html#ga560b271d9e1ccd1294f64e1bd01aa5d1"></a><br/></td></tr>
<tr class="separator:ga560b271d9e1ccd1294f64e1bd01aa5d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga81d175423a5061d3aa8e778fc5534bed"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__discrete.html#ga81d175423a5061d3aa8e778fc5534bed">readDiscreteInputs</a> (uint16_t, uint16_t)</td></tr>
<tr class="memdesc:ga81d175423a5061d3aa8e778fc5534bed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modbus function 0x02 Read Discrete Inputs.  <a href="group__discrete.html#ga81d175423a5061d3aa8e778fc5534bed"></a><br/></td></tr>
<tr class="separator:ga81d175423a5061d3aa8e778fc5534bed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9ffe845bb045dab15afc02a9e72b8d6e"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__register.html#ga9ffe845bb045dab15afc02a9e72b8d6e">readHoldingRegisters</a> (uint16_t, uint16_t)</td></tr>
<tr class="memdesc:ga9ffe845bb045dab15afc02a9e72b8d6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modbus function 0x03 Read Holding Registers.  <a href="group__register.html#ga9ffe845bb045dab15afc02a9e72b8d6e"></a><br/></td></tr>
<tr class="separator:ga9ffe845bb045dab15afc02a9e72b8d6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9094a4770bf9fac0abe2f34aac3a40ec"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__register.html#ga9094a4770bf9fac0abe2f34aac3a40ec">readInputRegisters</a> (uint16_t, uint8_t)</td></tr>
<tr class="memdesc:ga9094a4770bf9fac0abe2f34aac3a40ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modbus function 0x04 Read Input Registers.  <a href="group__register.html#ga9094a4770bf9fac0abe2f34aac3a40ec"></a><br/></td></tr>
<tr class="separator:ga9094a4770bf9fac0abe2f34aac3a40ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa132b7dee3f46d6f6aa625bba4ad25bf"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__discrete.html#gaa132b7dee3f46d6f6aa625bba4ad25bf">writeSingleCoil</a> (uint16_t, uint8_t)</td></tr>
<tr class="memdesc:gaa132b7dee3f46d6f6aa625bba4ad25bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modbus function 0x05 Write Single Coil.  <a href="group__discrete.html#gaa132b7dee3f46d6f6aa625bba4ad25bf"></a><br/></td></tr>
<tr class="separator:gaa132b7dee3f46d6f6aa625bba4ad25bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac3b5510cf862f3d584e393d07cd6ceed"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__register.html#gac3b5510cf862f3d584e393d07cd6ceed">writeSingleRegister</a> (uint16_t, uint16_t)</td></tr>
<tr class="memdesc:gac3b5510cf862f3d584e393d07cd6ceed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modbus function 0x06 Write Single Register.  <a href="group__register.html#gac3b5510cf862f3d584e393d07cd6ceed"></a><br/></td></tr>
<tr class="separator:gac3b5510cf862f3d584e393d07cd6ceed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga01eb4d05f58d6ae00c6db680cf00c423"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__discrete.html#ga01eb4d05f58d6ae00c6db680cf00c423">writeMultipleCoils</a> (uint16_t, uint16_t)</td></tr>
<tr class="memdesc:ga01eb4d05f58d6ae00c6db680cf00c423"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modbus function 0x0F Write Multiple Coils.  <a href="group__discrete.html#ga01eb4d05f58d6ae00c6db680cf00c423"></a><br/></td></tr>
<tr class="separator:ga01eb4d05f58d6ae00c6db680cf00c423"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a385d0c743d74341a01d96e7da7a5d4fd"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a385d0c743d74341a01d96e7da7a5d4fd"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>writeMultipleCoils</b> ()</td></tr>
<tr class="separator:a385d0c743d74341a01d96e7da7a5d4fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga53c894306b676cc702851e204acaad3e"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__register.html#ga53c894306b676cc702851e204acaad3e">writeMultipleRegisters</a> (uint16_t, uint16_t)</td></tr>
<tr class="memdesc:ga53c894306b676cc702851e204acaad3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modbus function 0x10 Write Multiple Registers.  <a href="group__register.html#ga53c894306b676cc702851e204acaad3e"></a><br/></td></tr>
<tr class="separator:ga53c894306b676cc702851e204acaad3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74c730ea8722a8ae0444b71d24340b87"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a74c730ea8722a8ae0444b71d24340b87"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>writeMultipleRegisters</b> ()</td></tr>
<tr class="separator:a74c730ea8722a8ae0444b71d24340b87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0bd8f8cde67f0a4ee4e7dcae7df3b695"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__register.html#ga0bd8f8cde67f0a4ee4e7dcae7df3b695">maskWriteRegister</a> (uint16_t, uint16_t, uint16_t)</td></tr>
<tr class="memdesc:ga0bd8f8cde67f0a4ee4e7dcae7df3b695"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modbus function 0x16 Mask Write Register.  <a href="group__register.html#ga0bd8f8cde67f0a4ee4e7dcae7df3b695"></a><br/></td></tr>
<tr class="separator:ga0bd8f8cde67f0a4ee4e7dcae7df3b695"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5d764079d29620431fb97003cf54cc7b"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__register.html#ga5d764079d29620431fb97003cf54cc7b">readWriteMultipleRegisters</a> (uint16_t, uint16_t, uint16_t, uint16_t)</td></tr>
<tr class="memdesc:ga5d764079d29620431fb97003cf54cc7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modbus function 0x17 Read Write Multiple Registers.  <a href="group__register.html#ga5d764079d29620431fb97003cf54cc7b"></a><br/></td></tr>
<tr class="separator:ga5d764079d29620431fb97003cf54cc7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0c0f48bee7ccaaee58394466aba642b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac0c0f48bee7ccaaee58394466aba642b"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>readWriteMultipleRegisters</b> (uint16_t, uint16_t)</td></tr>
<tr class="separator:ac0c0f48bee7ccaaee58394466aba642b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:gaf69c1c360b84adc5bf1c7bbe071f1970"><td class="memItemLeft" align="right" valign="top">static const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__constant.html#gaf69c1c360b84adc5bf1c7bbe071f1970">ku8MBIllegalFunction</a> = 0x01</td></tr>
<tr class="memdesc:gaf69c1c360b84adc5bf1c7bbe071f1970"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modbus protocol illegal function exception.  <a href="group__constant.html#gaf69c1c360b84adc5bf1c7bbe071f1970"></a><br/></td></tr>
<tr class="separator:gaf69c1c360b84adc5bf1c7bbe071f1970"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5d90968b8bbc157f9937c2d9a866102d"><td class="memItemLeft" align="right" valign="top">static const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__constant.html#ga5d90968b8bbc157f9937c2d9a866102d">ku8MBIllegalDataAddress</a> = 0x02</td></tr>
<tr class="memdesc:ga5d90968b8bbc157f9937c2d9a866102d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modbus protocol illegal data address exception.  <a href="group__constant.html#ga5d90968b8bbc157f9937c2d9a866102d"></a><br/></td></tr>
<tr class="separator:ga5d90968b8bbc157f9937c2d9a866102d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa49d578ceaa82518573b3f7e2d925322"><td class="memItemLeft" align="right" valign="top">static const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__constant.html#gaa49d578ceaa82518573b3f7e2d925322">ku8MBIllegalDataValue</a> = 0x03</td></tr>
<tr class="memdesc:gaa49d578ceaa82518573b3f7e2d925322"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modbus protocol illegal data value exception.  <a href="group__constant.html#gaa49d578ceaa82518573b3f7e2d925322"></a><br/></td></tr>
<tr class="separator:gaa49d578ceaa82518573b3f7e2d925322"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3b26f812363d765a334d72635da74fe5"><td class="memItemLeft" align="right" valign="top">static const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__constant.html#ga3b26f812363d765a334d72635da74fe5">ku8MBSlaveDeviceFailure</a> = 0x04</td></tr>
<tr class="memdesc:ga3b26f812363d765a334d72635da74fe5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modbus protocol slave device failure exception.  <a href="group__constant.html#ga3b26f812363d765a334d72635da74fe5"></a><br/></td></tr>
<tr class="separator:ga3b26f812363d765a334d72635da74fe5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga81dd9e8d2936e369359777d67769a657"><td class="memItemLeft" align="right" valign="top">static const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__constant.html#ga81dd9e8d2936e369359777d67769a657">ku8MBSuccess</a> = 0x00</td></tr>
<tr class="memdesc:ga81dd9e8d2936e369359777d67769a657"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="class_modbus_master.html" title="Arduino class library for communicating with Modbus slaves over RS232/485 (via RTU protocol)...">ModbusMaster</a> success.  <a href="group__constant.html#ga81dd9e8d2936e369359777d67769a657"></a><br/></td></tr>
<tr class="separator:ga81dd9e8d2936e369359777d67769a657"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga19521b4671bdc1ded03af72e2f3b958e"><td class="memItemLeft" align="right" valign="top">static const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__constant.html#ga19521b4671bdc1ded03af72e2f3b958e">ku8MBInvalidSlaveID</a> = 0xE0</td></tr>
<tr class="memdesc:ga19521b4671bdc1ded03af72e2f3b958e"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="class_modbus_master.html" title="Arduino class library for communicating with Modbus slaves over RS232/485 (via RTU protocol)...">ModbusMaster</a> invalid response slave ID exception.  <a href="group__constant.html#ga19521b4671bdc1ded03af72e2f3b958e"></a><br/></td></tr>
<tr class="separator:ga19521b4671bdc1ded03af72e2f3b958e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga31e9072531cf487c137b68b5e1e68926"><td class="memItemLeft" align="right" valign="top">static const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__constant.html#ga31e9072531cf487c137b68b5e1e68926">ku8MBInvalidFunction</a> = 0xE1</td></tr>
<tr class="memdesc:ga31e9072531cf487c137b68b5e1e68926"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="class_modbus_master.html" title="Arduino class library for communicating with Modbus slaves over RS232/485 (via RTU protocol)...">ModbusMaster</a> invalid response function exception.  <a href="group__constant.html#ga31e9072531cf487c137b68b5e1e68926"></a><br/></td></tr>
<tr class="separator:ga31e9072531cf487c137b68b5e1e68926"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8eb8e14ee2bcf58afc3fbbb4014f297c"><td class="memItemLeft" align="right" valign="top">static const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__constant.html#ga8eb8e14ee2bcf58afc3fbbb4014f297c">ku8MBResponseTimedOut</a> = 0xE2</td></tr>
<tr class="memdesc:ga8eb8e14ee2bcf58afc3fbbb4014f297c"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="class_modbus_master.html" title="Arduino class library for communicating with Modbus slaves over RS232/485 (via RTU protocol)...">ModbusMaster</a> response timed out exception.  <a href="group__constant.html#ga8eb8e14ee2bcf58afc3fbbb4014f297c"></a><br/></td></tr>
<tr class="separator:ga8eb8e14ee2bcf58afc3fbbb4014f297c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa73463392a988bbc5260690168b5ca08"><td class="memItemLeft" align="right" valign="top">static const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__constant.html#gaa73463392a988bbc5260690168b5ca08">ku8MBInvalidCRC</a> = 0xE3</td></tr>
<tr class="memdesc:gaa73463392a988bbc5260690168b5ca08"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="class_modbus_master.html" title="Arduino class library for communicating with Modbus slaves over RS232/485 (via RTU protocol)...">ModbusMaster</a> invalid response CRC exception.  <a href="group__constant.html#gaa73463392a988bbc5260690168b5ca08"></a><br/></td></tr>
<tr class="separator:gaa73463392a988bbc5260690168b5ca08"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a4c88df0ed38e98457e8ac74c2ed5dc81"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_modbus_master.html#a4c88df0ed38e98457e8ac74c2ed5dc81">ModbusMasterTransaction</a> (uint8_t u8MBFunction)</td></tr>
<tr class="memdesc:a4c88df0ed38e98457e8ac74c2ed5dc81"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modbus transaction engine.  <a href="#a4c88df0ed38e98457e8ac74c2ed5dc81"></a><br/></td></tr>
<tr class="separator:a4c88df0ed38e98457e8ac74c2ed5dc81"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a8059450709d3ef2f7b817e24ede57a94"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8059450709d3ef2f7b817e24ede57a94"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_modbus_master.html#a8059450709d3ef2f7b817e24ede57a94">_u8SerialPort</a></td></tr>
<tr class="memdesc:a8059450709d3ef2f7b817e24ede57a94"><td class="mdescLeft">&#160;</td><td class="mdescRight">serial port (0..3) initialized in constructor <br/></td></tr>
<tr class="separator:a8059450709d3ef2f7b817e24ede57a94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bc19d22b864e85ad67b4b633fa56597"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8bc19d22b864e85ad67b4b633fa56597"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_modbus_master.html#a8bc19d22b864e85ad67b4b633fa56597">_u8MBSlave</a></td></tr>
<tr class="memdesc:a8bc19d22b864e85ad67b4b633fa56597"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modbus slave (1..255) initialized in constructor. <br/></td></tr>
<tr class="separator:a8bc19d22b864e85ad67b4b633fa56597"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c3bdb0037ef87da266e46a6ecdd8a84"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2c3bdb0037ef87da266e46a6ecdd8a84"></a>
uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_modbus_master.html#a2c3bdb0037ef87da266e46a6ecdd8a84">_u16BaudRate</a></td></tr>
<tr class="memdesc:a2c3bdb0037ef87da266e46a6ecdd8a84"><td class="mdescLeft">&#160;</td><td class="mdescRight">baud rate (300..115200) initialized in <a class="el" href="group__setup.html#ga0f393213ede2f78801fca5add4eab139" title="Initialize class object.">begin()</a> <br/></td></tr>
<tr class="separator:a2c3bdb0037ef87da266e46a6ecdd8a84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfb48ef6321f738cc4b55c4b6e4a6335"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adfb48ef6321f738cc4b55c4b6e4a6335"></a>
uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_modbus_master.html#adfb48ef6321f738cc4b55c4b6e4a6335">_u16ReadAddress</a></td></tr>
<tr class="memdesc:adfb48ef6321f738cc4b55c4b6e4a6335"><td class="mdescLeft">&#160;</td><td class="mdescRight">slave register from which to read <br/></td></tr>
<tr class="separator:adfb48ef6321f738cc4b55c4b6e4a6335"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a043a88f0b184accd9176770dee55a6b3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a043a88f0b184accd9176770dee55a6b3"></a>
uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_modbus_master.html#a043a88f0b184accd9176770dee55a6b3">_u16ReadQty</a></td></tr>
<tr class="memdesc:a043a88f0b184accd9176770dee55a6b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">quantity of words to read <br/></td></tr>
<tr class="separator:a043a88f0b184accd9176770dee55a6b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a347a26fa1b91d7d0210b021e52a95268"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a347a26fa1b91d7d0210b021e52a95268"></a>
uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_modbus_master.html#a347a26fa1b91d7d0210b021e52a95268">_u16ResponseBuffer</a> [<a class="el" href="class_modbus_master.html#ab9a1a34c8e3bbd84529230e559694c29">ku8MaxBufferSize</a>]</td></tr>
<tr class="memdesc:a347a26fa1b91d7d0210b021e52a95268"><td class="mdescLeft">&#160;</td><td class="mdescRight">buffer to store Modbus slave response; read via GetResponseBuffer() <br/></td></tr>
<tr class="separator:a347a26fa1b91d7d0210b021e52a95268"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00edff3fbd53d94dcc1b6be593c61289"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a00edff3fbd53d94dcc1b6be593c61289"></a>
uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_modbus_master.html#a00edff3fbd53d94dcc1b6be593c61289">_u16WriteAddress</a></td></tr>
<tr class="memdesc:a00edff3fbd53d94dcc1b6be593c61289"><td class="mdescLeft">&#160;</td><td class="mdescRight">slave register to which to write <br/></td></tr>
<tr class="separator:a00edff3fbd53d94dcc1b6be593c61289"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3191c5da05cf72e117814ba0472b420"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad3191c5da05cf72e117814ba0472b420"></a>
uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_modbus_master.html#ad3191c5da05cf72e117814ba0472b420">_u16WriteQty</a></td></tr>
<tr class="memdesc:ad3191c5da05cf72e117814ba0472b420"><td class="mdescLeft">&#160;</td><td class="mdescRight">quantity of words to write <br/></td></tr>
<tr class="separator:ad3191c5da05cf72e117814ba0472b420"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a79a050ef684f78b06b7543a56f54fb"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8a79a050ef684f78b06b7543a56f54fb"></a>
uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_modbus_master.html#a8a79a050ef684f78b06b7543a56f54fb">_u16TransmitBuffer</a> [<a class="el" href="class_modbus_master.html#ab9a1a34c8e3bbd84529230e559694c29">ku8MaxBufferSize</a>]</td></tr>
<tr class="memdesc:a8a79a050ef684f78b06b7543a56f54fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">buffer containing data to transmit to Modbus slave; set via SetTransmitBuffer() <br/></td></tr>
<tr class="separator:a8a79a050ef684f78b06b7543a56f54fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a1319a6a43f2c0c35fae0d73ecb78f2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8a1319a6a43f2c0c35fae0d73ecb78f2"></a>
uint16_t *&#160;</td><td class="memItemRight" valign="bottom"><b>txBuffer</b></td></tr>
<tr class="separator:a8a1319a6a43f2c0c35fae0d73ecb78f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab13bbff1d0d0cc8cbe6728759c12ce94"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab13bbff1d0d0cc8cbe6728759c12ce94"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>_u8TransmitBufferIndex</b></td></tr>
<tr class="separator:ab13bbff1d0d0cc8cbe6728759c12ce94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adaaca6b41ea08b17b03c91a235b2af54"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adaaca6b41ea08b17b03c91a235b2af54"></a>
uint16_t&#160;</td><td class="memItemRight" valign="bottom"><b>u16TransmitBufferLength</b></td></tr>
<tr class="separator:adaaca6b41ea08b17b03c91a235b2af54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae252e46565b5534c93be3932297aca7e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae252e46565b5534c93be3932297aca7e"></a>
uint16_t *&#160;</td><td class="memItemRight" valign="bottom"><b>rxBuffer</b></td></tr>
<tr class="separator:ae252e46565b5534c93be3932297aca7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e045fe6a006da61e0a4c102a6ebab34"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6e045fe6a006da61e0a4c102a6ebab34"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>_u8ResponseBufferIndex</b></td></tr>
<tr class="separator:a6e045fe6a006da61e0a4c102a6ebab34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab339c85b44371f9c5ea76ce7041e47a4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab339c85b44371f9c5ea76ce7041e47a4"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>_u8ResponseBufferLength</b></td></tr>
<tr class="separator:ab339c85b44371f9c5ea76ce7041e47a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0d0099a1d7311f890f2788e08dd9625"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae0d0099a1d7311f890f2788e08dd9625"></a>
void(*&#160;</td><td class="memItemRight" valign="bottom"><b>_idle</b> )()</td></tr>
<tr class="separator:ae0d0099a1d7311f890f2788e08dd9625"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr class="memitem:ab9a1a34c8e3bbd84529230e559694c29"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab9a1a34c8e3bbd84529230e559694c29"></a>
static const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_modbus_master.html#ab9a1a34c8e3bbd84529230e559694c29">ku8MaxBufferSize</a> = 64</td></tr>
<tr class="memdesc:ab9a1a34c8e3bbd84529230e559694c29"><td class="mdescLeft">&#160;</td><td class="mdescRight">size of response/transmit buffers <br/></td></tr>
<tr class="separator:ab9a1a34c8e3bbd84529230e559694c29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7e7aa7bed1b86f24bd577725edc633d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad7e7aa7bed1b86f24bd577725edc633d"></a>
static const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_modbus_master.html#ad7e7aa7bed1b86f24bd577725edc633d">ku8MBReadCoils</a> = 0x01</td></tr>
<tr class="memdesc:ad7e7aa7bed1b86f24bd577725edc633d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modbus function 0x01 Read Coils. <br/></td></tr>
<tr class="separator:ad7e7aa7bed1b86f24bd577725edc633d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae08306bd72d5487bccf16c12ade79098"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae08306bd72d5487bccf16c12ade79098"></a>
static const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_modbus_master.html#ae08306bd72d5487bccf16c12ade79098">ku8MBReadDiscreteInputs</a> = 0x02</td></tr>
<tr class="memdesc:ae08306bd72d5487bccf16c12ade79098"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modbus function 0x02 Read Discrete Inputs. <br/></td></tr>
<tr class="separator:ae08306bd72d5487bccf16c12ade79098"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a401bf89674f94726efca951115704869"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a401bf89674f94726efca951115704869"></a>
static const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_modbus_master.html#a401bf89674f94726efca951115704869">ku8MBWriteSingleCoil</a> = 0x05</td></tr>
<tr class="memdesc:a401bf89674f94726efca951115704869"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modbus function 0x05 Write Single Coil. <br/></td></tr>
<tr class="separator:a401bf89674f94726efca951115704869"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31e5f44d74fa84bf4c9440c82d123fe9"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a31e5f44d74fa84bf4c9440c82d123fe9"></a>
static const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_modbus_master.html#a31e5f44d74fa84bf4c9440c82d123fe9">ku8MBWriteMultipleCoils</a> = 0x0F</td></tr>
<tr class="memdesc:a31e5f44d74fa84bf4c9440c82d123fe9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modbus function 0x0F Write Multiple Coils. <br/></td></tr>
<tr class="separator:a31e5f44d74fa84bf4c9440c82d123fe9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6995c167c152d96b06a918869c03623"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae6995c167c152d96b06a918869c03623"></a>
static const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_modbus_master.html#ae6995c167c152d96b06a918869c03623">ku8MBReadHoldingRegisters</a> = 0x03</td></tr>
<tr class="memdesc:ae6995c167c152d96b06a918869c03623"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modbus function 0x03 Read Holding Registers. <br/></td></tr>
<tr class="separator:ae6995c167c152d96b06a918869c03623"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeaa94736b198f6a05cf74e0466afb443"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aeaa94736b198f6a05cf74e0466afb443"></a>
static const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_modbus_master.html#aeaa94736b198f6a05cf74e0466afb443">ku8MBReadInputRegisters</a> = 0x04</td></tr>
<tr class="memdesc:aeaa94736b198f6a05cf74e0466afb443"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modbus function 0x04 Read Input Registers. <br/></td></tr>
<tr class="separator:aeaa94736b198f6a05cf74e0466afb443"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab68b007cd9473c3ed09f36fb0f6ee3fa"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab68b007cd9473c3ed09f36fb0f6ee3fa"></a>
static const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_modbus_master.html#ab68b007cd9473c3ed09f36fb0f6ee3fa">ku8MBWriteSingleRegister</a> = 0x06</td></tr>
<tr class="memdesc:ab68b007cd9473c3ed09f36fb0f6ee3fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modbus function 0x06 Write Single Register. <br/></td></tr>
<tr class="separator:ab68b007cd9473c3ed09f36fb0f6ee3fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf1f58e7806d4c7bc1638255e2639b86"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adf1f58e7806d4c7bc1638255e2639b86"></a>
static const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_modbus_master.html#adf1f58e7806d4c7bc1638255e2639b86">ku8MBWriteMultipleRegisters</a> = 0x10</td></tr>
<tr class="memdesc:adf1f58e7806d4c7bc1638255e2639b86"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modbus function 0x10 Write Multiple Registers. <br/></td></tr>
<tr class="separator:adf1f58e7806d4c7bc1638255e2639b86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1de5e699bcada855fb26e336d2cd2cd3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1de5e699bcada855fb26e336d2cd2cd3"></a>
static const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_modbus_master.html#a1de5e699bcada855fb26e336d2cd2cd3">ku8MBMaskWriteRegister</a> = 0x16</td></tr>
<tr class="memdesc:a1de5e699bcada855fb26e336d2cd2cd3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modbus function 0x16 Mask Write Register. <br/></td></tr>
<tr class="separator:a1de5e699bcada855fb26e336d2cd2cd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1c77f6f5f7e0f19d0c9b9916dca2263"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af1c77f6f5f7e0f19d0c9b9916dca2263"></a>
static const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_modbus_master.html#af1c77f6f5f7e0f19d0c9b9916dca2263">ku8MBReadWriteMultipleRegisters</a> = 0x17</td></tr>
<tr class="memdesc:af1c77f6f5f7e0f19d0c9b9916dca2263"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modbus function 0x17 Read Write Multiple Registers. <br/></td></tr>
<tr class="separator:af1c77f6f5f7e0f19d0c9b9916dca2263"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9c5d42e3b5cd7ec40ce0c86f6fc1772"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac9c5d42e3b5cd7ec40ce0c86f6fc1772"></a>
static const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_modbus_master.html#ac9c5d42e3b5cd7ec40ce0c86f6fc1772">ku8MBResponseTimeout</a> = 200</td></tr>
<tr class="memdesc:ac9c5d42e3b5cd7ec40ce0c86f6fc1772"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modbus timeout [milliseconds]. <br/></td></tr>
<tr class="separator:ac9c5d42e3b5cd7ec40ce0c86f6fc1772"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Arduino class library for communicating with Modbus slaves over RS232/485 (via RTU protocol). </p>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="examples_2_basic_2_basic_8pde-example.html#_a0">examples/Basic/Basic.pde</a>, and <a class="el" href="examples_2_phoenix_contact_nano_l_c_2_phoenix_contact_nano_l_c_8pde-example.html#_a0">examples/PhoenixContact_nanoLC/PhoenixContact_nanoLC.pde</a>.</dd>
</dl></div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="aea6654dac81e6b692dd6a1b0be8a218e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ModbusMaster::idle </td>
          <td>(</td>
          <td class="paramtype">void(*)()&#160;</td>
          <td class="paramname"><em>idle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set idle time callback function (cooperative multitasking). </p>
<p>This function gets called in the idle time between transmission of data and response from slave. Do not call functions that read from the serial buffer that is used by <a class="el" href="class_modbus_master.html" title="Arduino class library for communicating with Modbus slaves over RS232/485 (via RTU protocol)...">ModbusMaster</a>. Use of i2c/TWI, 1-Wire, other serial ports, etc. is permitted within callback function.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="class_modbus_master.html#a4c88df0ed38e98457e8ac74c2ed5dc81" title="Modbus transaction engine.">ModbusMaster::ModbusMasterTransaction()</a> </dd></dl>
<div class="fragment"><div class="line">{</div>
<div class="line">  _idle = <a class="code" href="class_modbus_master.html#aea6654dac81e6b692dd6a1b0be8a218e" title="Set idle time callback function (cooperative multitasking).">idle</a>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4c88df0ed38e98457e8ac74c2ed5dc81"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t ModbusMaster::ModbusMasterTransaction </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>u8MBFunction</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Modbus transaction engine. </p>
<p>Sequence:</p>
<ul>
<li>assemble Modbus Request Application Data Unit (ADU), based on particular function called</li>
<li>transmit request over selected serial port</li>
<li>wait for/retrieve response</li>
<li>evaluate/disassemble response</li>
<li>return status (success/exception)</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">u8MBFunction</td><td>Modbus function (0x01..0xFF) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success; exception number on failure </dd></dl>
<div class="fragment"><div class="line">{</div>
<div class="line">  uint8_t u8ModbusADU[256];</div>
<div class="line">  uint8_t u8ModbusADUSize = 0;</div>
<div class="line">  uint8_t i, u8Qty;</div>
<div class="line">  uint16_t u16CRC;</div>
<div class="line">  uint32_t u32StartTime;</div>
<div class="line">  uint8_t u8BytesLeft = 8;</div>
<div class="line">  uint8_t u8MBStatus = <a class="code" href="group__constant.html#ga81dd9e8d2936e369359777d67769a657" title="ModbusMaster success.">ku8MBSuccess</a>;</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// assemble Modbus Request Application Data Unit</span></div>
<div class="line">  u8ModbusADU[u8ModbusADUSize++] = <a class="code" href="class_modbus_master.html#a8bc19d22b864e85ad67b4b633fa56597" title="Modbus slave (1..255) initialized in constructor.">_u8MBSlave</a>;</div>
<div class="line">  u8ModbusADU[u8ModbusADUSize++] = u8MBFunction;</div>
<div class="line">  </div>
<div class="line">  <span class="keywordflow">switch</span>(u8MBFunction)</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="class_modbus_master.html#ad7e7aa7bed1b86f24bd577725edc633d" title="Modbus function 0x01 Read Coils.">ku8MBReadCoils</a>:</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="class_modbus_master.html#ae08306bd72d5487bccf16c12ade79098" title="Modbus function 0x02 Read Discrete Inputs.">ku8MBReadDiscreteInputs</a>:</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="class_modbus_master.html#aeaa94736b198f6a05cf74e0466afb443" title="Modbus function 0x04 Read Input Registers.">ku8MBReadInputRegisters</a>:</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="class_modbus_master.html#ae6995c167c152d96b06a918869c03623" title="Modbus function 0x03 Read Holding Registers.">ku8MBReadHoldingRegisters</a>:</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="class_modbus_master.html#af1c77f6f5f7e0f19d0c9b9916dca2263" title="Modbus function 0x17 Read Write Multiple Registers.">ku8MBReadWriteMultipleRegisters</a>:</div>
<div class="line">      u8ModbusADU[u8ModbusADUSize++] = highByte(<a class="code" href="class_modbus_master.html#adfb48ef6321f738cc4b55c4b6e4a6335" title="slave register from which to read">_u16ReadAddress</a>);</div>
<div class="line">      u8ModbusADU[u8ModbusADUSize++] = lowByte(<a class="code" href="class_modbus_master.html#adfb48ef6321f738cc4b55c4b6e4a6335" title="slave register from which to read">_u16ReadAddress</a>);</div>
<div class="line">      u8ModbusADU[u8ModbusADUSize++] = highByte(<a class="code" href="class_modbus_master.html#a043a88f0b184accd9176770dee55a6b3" title="quantity of words to read">_u16ReadQty</a>);</div>
<div class="line">      u8ModbusADU[u8ModbusADUSize++] = lowByte(<a class="code" href="class_modbus_master.html#a043a88f0b184accd9176770dee55a6b3" title="quantity of words to read">_u16ReadQty</a>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line">  <span class="keywordflow">switch</span>(u8MBFunction)</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="class_modbus_master.html#a401bf89674f94726efca951115704869" title="Modbus function 0x05 Write Single Coil.">ku8MBWriteSingleCoil</a>:</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="class_modbus_master.html#a1de5e699bcada855fb26e336d2cd2cd3" title="Modbus function 0x16 Mask Write Register.">ku8MBMaskWriteRegister</a>:</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="class_modbus_master.html#a31e5f44d74fa84bf4c9440c82d123fe9" title="Modbus function 0x0F Write Multiple Coils.">ku8MBWriteMultipleCoils</a>:</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="class_modbus_master.html#ab68b007cd9473c3ed09f36fb0f6ee3fa" title="Modbus function 0x06 Write Single Register.">ku8MBWriteSingleRegister</a>:</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="class_modbus_master.html#adf1f58e7806d4c7bc1638255e2639b86" title="Modbus function 0x10 Write Multiple Registers.">ku8MBWriteMultipleRegisters</a>:</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="class_modbus_master.html#af1c77f6f5f7e0f19d0c9b9916dca2263" title="Modbus function 0x17 Read Write Multiple Registers.">ku8MBReadWriteMultipleRegisters</a>:</div>
<div class="line">      u8ModbusADU[u8ModbusADUSize++] = highByte(<a class="code" href="class_modbus_master.html#a00edff3fbd53d94dcc1b6be593c61289" title="slave register to which to write">_u16WriteAddress</a>);</div>
<div class="line">      u8ModbusADU[u8ModbusADUSize++] = lowByte(<a class="code" href="class_modbus_master.html#a00edff3fbd53d94dcc1b6be593c61289" title="slave register to which to write">_u16WriteAddress</a>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line">  <span class="keywordflow">switch</span>(u8MBFunction)</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="class_modbus_master.html#a401bf89674f94726efca951115704869" title="Modbus function 0x05 Write Single Coil.">ku8MBWriteSingleCoil</a>:</div>
<div class="line">      u8ModbusADU[u8ModbusADUSize++] = highByte(<a class="code" href="class_modbus_master.html#ad3191c5da05cf72e117814ba0472b420" title="quantity of words to write">_u16WriteQty</a>);</div>
<div class="line">      u8ModbusADU[u8ModbusADUSize++] = lowByte(<a class="code" href="class_modbus_master.html#ad3191c5da05cf72e117814ba0472b420" title="quantity of words to write">_u16WriteQty</a>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">      </div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="class_modbus_master.html#ab68b007cd9473c3ed09f36fb0f6ee3fa" title="Modbus function 0x06 Write Single Register.">ku8MBWriteSingleRegister</a>:</div>
<div class="line">      u8ModbusADU[u8ModbusADUSize++] = highByte(<a class="code" href="class_modbus_master.html#a8a79a050ef684f78b06b7543a56f54fb" title="buffer containing data to transmit to Modbus slave; set via SetTransmitBuffer()">_u16TransmitBuffer</a>[0]);</div>
<div class="line">      u8ModbusADU[u8ModbusADUSize++] = lowByte(<a class="code" href="class_modbus_master.html#a8a79a050ef684f78b06b7543a56f54fb" title="buffer containing data to transmit to Modbus slave; set via SetTransmitBuffer()">_u16TransmitBuffer</a>[0]);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">      </div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="class_modbus_master.html#a31e5f44d74fa84bf4c9440c82d123fe9" title="Modbus function 0x0F Write Multiple Coils.">ku8MBWriteMultipleCoils</a>:</div>
<div class="line">      u8ModbusADU[u8ModbusADUSize++] = highByte(<a class="code" href="class_modbus_master.html#ad3191c5da05cf72e117814ba0472b420" title="quantity of words to write">_u16WriteQty</a>);</div>
<div class="line">      u8ModbusADU[u8ModbusADUSize++] = lowByte(<a class="code" href="class_modbus_master.html#ad3191c5da05cf72e117814ba0472b420" title="quantity of words to write">_u16WriteQty</a>);</div>
<div class="line">      u8Qty = (<a class="code" href="class_modbus_master.html#ad3191c5da05cf72e117814ba0472b420" title="quantity of words to write">_u16WriteQty</a> % 8) ? ((<a class="code" href="class_modbus_master.html#ad3191c5da05cf72e117814ba0472b420" title="quantity of words to write">_u16WriteQty</a> &gt;&gt; 3) + 1) : (<a class="code" href="class_modbus_master.html#ad3191c5da05cf72e117814ba0472b420" title="quantity of words to write">_u16WriteQty</a> &gt;&gt; 3);</div>
<div class="line">      u8ModbusADU[u8ModbusADUSize++] = u8Qty;</div>
<div class="line">      <span class="keywordflow">for</span> (i = 0; i &lt; u8Qty; i++)</div>
<div class="line">      {</div>
<div class="line">        <span class="keywordflow">switch</span>(i % 2)</div>
<div class="line">        {</div>
<div class="line">          <span class="keywordflow">case</span> 0: <span class="comment">// i is even</span></div>
<div class="line">            u8ModbusADU[u8ModbusADUSize++] = lowByte(<a class="code" href="class_modbus_master.html#a8a79a050ef684f78b06b7543a56f54fb" title="buffer containing data to transmit to Modbus slave; set via SetTransmitBuffer()">_u16TransmitBuffer</a>[i &gt;&gt; 1]);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">            </div>
<div class="line">          <span class="keywordflow">case</span> 1: <span class="comment">// i is odd</span></div>
<div class="line">            u8ModbusADU[u8ModbusADUSize++] = highByte(<a class="code" href="class_modbus_master.html#a8a79a050ef684f78b06b7543a56f54fb" title="buffer containing data to transmit to Modbus slave; set via SetTransmitBuffer()">_u16TransmitBuffer</a>[i &gt;&gt; 1]);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">      </div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="class_modbus_master.html#adf1f58e7806d4c7bc1638255e2639b86" title="Modbus function 0x10 Write Multiple Registers.">ku8MBWriteMultipleRegisters</a>:</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="class_modbus_master.html#af1c77f6f5f7e0f19d0c9b9916dca2263" title="Modbus function 0x17 Read Write Multiple Registers.">ku8MBReadWriteMultipleRegisters</a>:</div>
<div class="line">      u8ModbusADU[u8ModbusADUSize++] = highByte(<a class="code" href="class_modbus_master.html#ad3191c5da05cf72e117814ba0472b420" title="quantity of words to write">_u16WriteQty</a>);</div>
<div class="line">      u8ModbusADU[u8ModbusADUSize++] = lowByte(<a class="code" href="class_modbus_master.html#ad3191c5da05cf72e117814ba0472b420" title="quantity of words to write">_u16WriteQty</a>);</div>
<div class="line">      u8ModbusADU[u8ModbusADUSize++] = lowByte(<a class="code" href="class_modbus_master.html#ad3191c5da05cf72e117814ba0472b420" title="quantity of words to write">_u16WriteQty</a> &lt;&lt; 1);</div>
<div class="line">      </div>
<div class="line">      <span class="keywordflow">for</span> (i = 0; i &lt; lowByte(<a class="code" href="class_modbus_master.html#ad3191c5da05cf72e117814ba0472b420" title="quantity of words to write">_u16WriteQty</a>); i++)</div>
<div class="line">      {</div>
<div class="line">        u8ModbusADU[u8ModbusADUSize++] = highByte(<a class="code" href="class_modbus_master.html#a8a79a050ef684f78b06b7543a56f54fb" title="buffer containing data to transmit to Modbus slave; set via SetTransmitBuffer()">_u16TransmitBuffer</a>[i]);</div>
<div class="line">        u8ModbusADU[u8ModbusADUSize++] = lowByte(<a class="code" href="class_modbus_master.html#a8a79a050ef684f78b06b7543a56f54fb" title="buffer containing data to transmit to Modbus slave; set via SetTransmitBuffer()">_u16TransmitBuffer</a>[i]);</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">      </div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="class_modbus_master.html#a1de5e699bcada855fb26e336d2cd2cd3" title="Modbus function 0x16 Mask Write Register.">ku8MBMaskWriteRegister</a>:</div>
<div class="line">      u8ModbusADU[u8ModbusADUSize++] = highByte(<a class="code" href="class_modbus_master.html#a8a79a050ef684f78b06b7543a56f54fb" title="buffer containing data to transmit to Modbus slave; set via SetTransmitBuffer()">_u16TransmitBuffer</a>[0]);</div>
<div class="line">      u8ModbusADU[u8ModbusADUSize++] = lowByte(<a class="code" href="class_modbus_master.html#a8a79a050ef684f78b06b7543a56f54fb" title="buffer containing data to transmit to Modbus slave; set via SetTransmitBuffer()">_u16TransmitBuffer</a>[0]);</div>
<div class="line">      u8ModbusADU[u8ModbusADUSize++] = highByte(<a class="code" href="class_modbus_master.html#a8a79a050ef684f78b06b7543a56f54fb" title="buffer containing data to transmit to Modbus slave; set via SetTransmitBuffer()">_u16TransmitBuffer</a>[1]);</div>
<div class="line">      u8ModbusADU[u8ModbusADUSize++] = lowByte(<a class="code" href="class_modbus_master.html#a8a79a050ef684f78b06b7543a56f54fb" title="buffer containing data to transmit to Modbus slave; set via SetTransmitBuffer()">_u16TransmitBuffer</a>[1]);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// append CRC</span></div>
<div class="line">  u16CRC = 0xFFFF;</div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; u8ModbusADUSize; i++)</div>
<div class="line">  {</div>
<div class="line">    u16CRC = _crc16_update(u16CRC, u8ModbusADU[i]);</div>
<div class="line">  }</div>
<div class="line">  u8ModbusADU[u8ModbusADUSize++] = lowByte(u16CRC);</div>
<div class="line">  u8ModbusADU[u8ModbusADUSize++] = highByte(u16CRC);</div>
<div class="line">  u8ModbusADU[u8ModbusADUSize] = 0;</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// transmit request</span></div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; u8ModbusADUSize; i++)</div>
<div class="line">  {</div>
<div class="line"><span class="preprocessor">#if defined(ARDUINO) &amp;&amp; ARDUINO &gt;= 100</span></div>
<div class="line"><span class="preprocessor"></span>    MBSerial.write(u8ModbusADU[i]);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>    MBSerial.print(u8ModbusADU[i], BYTE);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>  }</div>
<div class="line">  </div>
<div class="line">  u8ModbusADUSize = 0;</div>
<div class="line">  MBSerial.flush();</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// loop until we run out of time or bytes, or an error occurs</span></div>
<div class="line">  u32StartTime = millis();</div>
<div class="line">  <span class="keywordflow">while</span> (u8BytesLeft &amp;&amp; !u8MBStatus)</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">if</span> (MBSerial.available())</div>
<div class="line">    {</div>
<div class="line"><span class="preprocessor">#if __MODBUSMASTER_DEBUG__</span></div>
<div class="line"><span class="preprocessor"></span>      digitalWrite(4, <span class="keyword">true</span>);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>      u8ModbusADU[u8ModbusADUSize++] = MBSerial.read();</div>
<div class="line">      u8BytesLeft--;</div>
<div class="line"><span class="preprocessor">#if __MODBUSMASTER_DEBUG__</span></div>
<div class="line"><span class="preprocessor"></span>      digitalWrite(4, <span class="keyword">false</span>);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line"><span class="preprocessor">#if __MODBUSMASTER_DEBUG__</span></div>
<div class="line"><span class="preprocessor"></span>      digitalWrite(5, <span class="keyword">true</span>);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>      <span class="keywordflow">if</span> (_idle)</div>
<div class="line">      {</div>
<div class="line">        _idle();</div>
<div class="line">      }</div>
<div class="line"><span class="preprocessor">#if __MODBUSMASTER_DEBUG__</span></div>
<div class="line"><span class="preprocessor"></span>      digitalWrite(5, <span class="keyword">false</span>);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// evaluate slave ID, function code once enough bytes have been read</span></div>
<div class="line">    <span class="keywordflow">if</span> (u8ModbusADUSize == 5)</div>
<div class="line">    {</div>
<div class="line">      <span class="comment">// verify response is for correct Modbus slave</span></div>
<div class="line">      <span class="keywordflow">if</span> (u8ModbusADU[0] != <a class="code" href="class_modbus_master.html#a8bc19d22b864e85ad67b4b633fa56597" title="Modbus slave (1..255) initialized in constructor.">_u8MBSlave</a>)</div>
<div class="line">      {</div>
<div class="line">        u8MBStatus = <a class="code" href="group__constant.html#ga19521b4671bdc1ded03af72e2f3b958e" title="ModbusMaster invalid response slave ID exception.">ku8MBInvalidSlaveID</a>;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">      </div>
<div class="line">      <span class="comment">// verify response is for correct Modbus function code (mask exception bit 7)</span></div>
<div class="line">      <span class="keywordflow">if</span> ((u8ModbusADU[1] &amp; 0x7F) != u8MBFunction)</div>
<div class="line">      {</div>
<div class="line">        u8MBStatus = <a class="code" href="group__constant.html#ga31e9072531cf487c137b68b5e1e68926" title="ModbusMaster invalid response function exception.">ku8MBInvalidFunction</a>;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">      </div>
<div class="line">      <span class="comment">// check whether Modbus exception occurred; return Modbus Exception Code</span></div>
<div class="line">      <span class="keywordflow">if</span> (bitRead(u8ModbusADU[1], 7))</div>
<div class="line">      {</div>
<div class="line">        u8MBStatus = u8ModbusADU[2];</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">      </div>
<div class="line">      <span class="comment">// evaluate returned Modbus function code</span></div>
<div class="line">      <span class="keywordflow">switch</span>(u8ModbusADU[1])</div>
<div class="line">      {</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="class_modbus_master.html#ad7e7aa7bed1b86f24bd577725edc633d" title="Modbus function 0x01 Read Coils.">ku8MBReadCoils</a>:</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="class_modbus_master.html#ae08306bd72d5487bccf16c12ade79098" title="Modbus function 0x02 Read Discrete Inputs.">ku8MBReadDiscreteInputs</a>:</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="class_modbus_master.html#aeaa94736b198f6a05cf74e0466afb443" title="Modbus function 0x04 Read Input Registers.">ku8MBReadInputRegisters</a>:</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="class_modbus_master.html#ae6995c167c152d96b06a918869c03623" title="Modbus function 0x03 Read Holding Registers.">ku8MBReadHoldingRegisters</a>:</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="class_modbus_master.html#af1c77f6f5f7e0f19d0c9b9916dca2263" title="Modbus function 0x17 Read Write Multiple Registers.">ku8MBReadWriteMultipleRegisters</a>:</div>
<div class="line">          u8BytesLeft = u8ModbusADU[2];</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">          </div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="class_modbus_master.html#a401bf89674f94726efca951115704869" title="Modbus function 0x05 Write Single Coil.">ku8MBWriteSingleCoil</a>:</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="class_modbus_master.html#a31e5f44d74fa84bf4c9440c82d123fe9" title="Modbus function 0x0F Write Multiple Coils.">ku8MBWriteMultipleCoils</a>:</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="class_modbus_master.html#ab68b007cd9473c3ed09f36fb0f6ee3fa" title="Modbus function 0x06 Write Single Register.">ku8MBWriteSingleRegister</a>:</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="class_modbus_master.html#adf1f58e7806d4c7bc1638255e2639b86" title="Modbus function 0x10 Write Multiple Registers.">ku8MBWriteMultipleRegisters</a>:</div>
<div class="line">          u8BytesLeft = 3;</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">          </div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="class_modbus_master.html#a1de5e699bcada855fb26e336d2cd2cd3" title="Modbus function 0x16 Mask Write Register.">ku8MBMaskWriteRegister</a>:</div>
<div class="line">          u8BytesLeft = 5;</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (millis() &gt; (u32StartTime + <a class="code" href="class_modbus_master.html#ac9c5d42e3b5cd7ec40ce0c86f6fc1772" title="Modbus timeout [milliseconds].">ku8MBResponseTimeout</a>))</div>
<div class="line">    {</div>
<div class="line">      u8MBStatus = <a class="code" href="group__constant.html#ga8eb8e14ee2bcf58afc3fbbb4014f297c" title="ModbusMaster response timed out exception.">ku8MBResponseTimedOut</a>;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// verify response is large enough to inspect further</span></div>
<div class="line">  <span class="keywordflow">if</span> (!u8MBStatus &amp;&amp; u8ModbusADUSize &gt;= 5)</div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// calculate CRC</span></div>
<div class="line">    u16CRC = 0xFFFF;</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; (u8ModbusADUSize - 2); i++)</div>
<div class="line">    {</div>
<div class="line">      u16CRC = _crc16_update(u16CRC, u8ModbusADU[i]);</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// verify CRC</span></div>
<div class="line">    <span class="keywordflow">if</span> (!u8MBStatus &amp;&amp; (lowByte(u16CRC) != u8ModbusADU[u8ModbusADUSize - 2] ||</div>
<div class="line">      highByte(u16CRC) != u8ModbusADU[u8ModbusADUSize - 1]))</div>
<div class="line">    {</div>
<div class="line">      u8MBStatus = <a class="code" href="group__constant.html#gaa73463392a988bbc5260690168b5ca08" title="ModbusMaster invalid response CRC exception.">ku8MBInvalidCRC</a>;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">// disassemble ADU into words</span></div>
<div class="line">  <span class="keywordflow">if</span> (!u8MBStatus)</div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// evaluate returned Modbus function code</span></div>
<div class="line">    <span class="keywordflow">switch</span>(u8ModbusADU[1])</div>
<div class="line">    {</div>
<div class="line">      <span class="keywordflow">case</span> <a class="code" href="class_modbus_master.html#ad7e7aa7bed1b86f24bd577725edc633d" title="Modbus function 0x01 Read Coils.">ku8MBReadCoils</a>:</div>
<div class="line">      <span class="keywordflow">case</span> <a class="code" href="class_modbus_master.html#ae08306bd72d5487bccf16c12ade79098" title="Modbus function 0x02 Read Discrete Inputs.">ku8MBReadDiscreteInputs</a>:</div>
<div class="line">        <span class="comment">// load bytes into word; response bytes are ordered L, H, L, H, ...</span></div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; (u8ModbusADU[2] &gt;&gt; 1); i++)</div>
<div class="line">        {</div>
<div class="line">          <span class="keywordflow">if</span> (i &lt; <a class="code" href="class_modbus_master.html#ab9a1a34c8e3bbd84529230e559694c29" title="size of response/transmit buffers">ku8MaxBufferSize</a>)</div>
<div class="line">          {</div>
<div class="line">            <a class="code" href="class_modbus_master.html#a347a26fa1b91d7d0210b021e52a95268" title="buffer to store Modbus slave response; read via GetResponseBuffer()">_u16ResponseBuffer</a>[i] = word(u8ModbusADU[2 * i + 4], u8ModbusADU[2 * i + 3]);</div>
<div class="line">          }</div>
<div class="line">          </div>
<div class="line">          _u8ResponseBufferLength = i;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// in the event of an odd number of bytes, load last byte into zero-padded word</span></div>
<div class="line">        <span class="keywordflow">if</span> (u8ModbusADU[2] % 2)</div>
<div class="line">        {</div>
<div class="line">          <span class="keywordflow">if</span> (i &lt; <a class="code" href="class_modbus_master.html#ab9a1a34c8e3bbd84529230e559694c29" title="size of response/transmit buffers">ku8MaxBufferSize</a>)</div>
<div class="line">          {</div>
<div class="line">            <a class="code" href="class_modbus_master.html#a347a26fa1b91d7d0210b021e52a95268" title="buffer to store Modbus slave response; read via GetResponseBuffer()">_u16ResponseBuffer</a>[i] = word(0, u8ModbusADU[2 * i + 3]);</div>
<div class="line">          }</div>
<div class="line">          </div>
<div class="line">          _u8ResponseBufferLength = i + 1;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">        </div>
<div class="line">      <span class="keywordflow">case</span> <a class="code" href="class_modbus_master.html#aeaa94736b198f6a05cf74e0466afb443" title="Modbus function 0x04 Read Input Registers.">ku8MBReadInputRegisters</a>:</div>
<div class="line">      <span class="keywordflow">case</span> <a class="code" href="class_modbus_master.html#ae6995c167c152d96b06a918869c03623" title="Modbus function 0x03 Read Holding Registers.">ku8MBReadHoldingRegisters</a>:</div>
<div class="line">      <span class="keywordflow">case</span> <a class="code" href="class_modbus_master.html#af1c77f6f5f7e0f19d0c9b9916dca2263" title="Modbus function 0x17 Read Write Multiple Registers.">ku8MBReadWriteMultipleRegisters</a>:</div>
<div class="line">        <span class="comment">// load bytes into word; response bytes are ordered H, L, H, L, ...</span></div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; (u8ModbusADU[2] &gt;&gt; 1); i++)</div>
<div class="line">        {</div>
<div class="line">          <span class="keywordflow">if</span> (i &lt; <a class="code" href="class_modbus_master.html#ab9a1a34c8e3bbd84529230e559694c29" title="size of response/transmit buffers">ku8MaxBufferSize</a>)</div>
<div class="line">          {</div>
<div class="line">            <a class="code" href="class_modbus_master.html#a347a26fa1b91d7d0210b021e52a95268" title="buffer to store Modbus slave response; read via GetResponseBuffer()">_u16ResponseBuffer</a>[i] = word(u8ModbusADU[2 * i + 3], u8ModbusADU[2 * i + 4]);</div>
<div class="line">          }</div>
<div class="line">          </div>
<div class="line">          _u8ResponseBufferLength = i;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line">  _u8TransmitBufferIndex = 0;</div>
<div class="line">  u16TransmitBufferLength = 0;</div>
<div class="line">  _u8ResponseBufferIndex = 0;</div>
<div class="line">  <span class="keywordflow">return</span> u8MBStatus;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_modbus_master_8h_source.html">ModbusMaster.h</a></li>
<li>ModbusMaster.cpp</li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="class_modbus_master.html">ModbusMaster</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.2 </li>
  </ul>
</div>
</body>
</html>
